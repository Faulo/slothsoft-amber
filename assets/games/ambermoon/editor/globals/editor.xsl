<?xml version="1.0" encoding="UTF-8"?><xsl:stylesheet version="1.0" 	xmlns="http://www.w3.org/1999/xhtml"	xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 	xmlns:saa="http://schema.slothsoft.net/amber/amberdata"	xmlns:sse="http://schema.slothsoft.net/savegame/editor"	xmlns:sfm="http://schema.slothsoft.net/farah/module">		<xsl:template match="/sfm:fragment">		<div class="Amber Editor" data-amber-game="{.//sse:savegame.editor/../@id}" data-amber-version="{.//sse:savegame.editor/../@url}"><!--ng-app="Amber" -->			<script type="application/javascript"><![CDATA[var savegameEditor;window.addEventListener(	"DOMContentLoaded",	function(eve) {		savegameEditor = new SavegameEditor(document.querySelector(".Amber"));	},	false);			]]></script>			<xsl:apply-templates select="*[@name='editor']" />			<!-- <div class="pickers"> <xsl:apply-templates select=".//saa:item-list" mode="picker" /> <xsl:apply-templates select=".//saa:portrait-list" 				mode="picker" /> <menu type="context" id="amber-picker-tile" onshow="savegameEditor.openMenu(arguments[0])"> <menuitem label="Ambermoon 				Tile Picker" icon="/getResource.php/slothsoft/favicon" /> </menu> </div> -->			<div class="popup" onclick="savegameEditor.closePopup(arguments[0])" />		</div>	</xsl:template>	<xsl:template match="*[@name='editor']">		<xsl:for-each select="sse:savegame.editor">			<xsl:variable name="selectedArchives" select="sse:archive[*]" />			<details open="open">				<summary>					<h2>Einstellungen</h2>				</summary>				<div>					<form method="POST" action="./?user={@save-id}" enctype="multipart/form-data">						<div>							<h3 class="name">Aktuelle Spielstand-ID</h3>							<input type="text" value="{@save-id}" readonly="readonly" size="40" />						</div>						<!--						<div>							<button class="yellow" type="submit" name="DownloadAll">XML								herunterladen</button>						</div>						-->						<div>							<h3 class="name">Bearbeitbare Dateien</h3>							<table class="settings">								<thead>									<tr class="gray">										<td>Dateiname</td>										<td>Größe</td>										<td>Letzte Änderung</td>										<td>Eigene Version Hochladen</td>									</tr>								</thead>								<tbody>									<xsl:for-each select="sse:archive">										<tr>											<td>												<label class="name">													<input type="radio" name="save[archiveId]" value="{@name}">														<xsl:if test="@name = $selectedArchives/@name">															<xsl:attribute name="checked">checked</xsl:attribute>														</xsl:if>													</input>													<xsl:text> </xsl:text>													<xsl:value-of select="@name" />												</label>											</td>											<td class="number">												<xsl:value-of select="ceiling(@size div 1000)" />												<xsl:text> kB</xsl:text>											</td>											<td class="number">												<xsl:value-of select="@timestamp" />											</td>											<td>												<input type="file" name="save[{@path}]" />											</td>										</tr>									</xsl:for-each>								</tbody>								<tfoot>									<tr>										<td colspan="3">											<button class="yellow" type="submit" name="save[action]" value="view">Ausgewählte Datei öffnen</button>										</td>										<td>											<button class="yellow" type="submit" name="save[action]" value="upload">Dateien hochladen</button>										</td>									</tr>								</tfoot>							</table>						</div>					</form>				</div>			</details>			<xsl:for-each select="$selectedArchives">				<details open="open">					<summary>						<h2>							Datei bearbeiten:							<span class="green">								<xsl:value-of select="@name" />							</span>						</h2>					</summary>					<xsl:apply-templates select="." mode="form" />				</details>			</xsl:for-each>		</xsl:for-each>	</xsl:template>	<xsl:template match="sse:archive" mode="form">		<form action="./?user={../@save-id}" method="POST">			<input name="save[archiveId]" type="hidden"  value="{@name}"/>			<button name="save[action]" type="submit" class="yellow" value="save">Speichern</button>			<button name="save[action]" type="submit" class="yellow" value="download">Download</button>			<xsl:apply-templates select="." mode="form-content" />		</form>	</xsl:template>	<xsl:template match="sse:archive" mode="form-content">		<xsl:choose>			<xsl:when test="count(sse:file) = 1">				<xsl:for-each select="sse:file">					<xsl:call-template name="savegame.flex">						<xsl:with-param name="items">							<xsl:for-each select="*">								<div>									<xsl:apply-templates select="." mode="item" />								</div>							</xsl:for-each>						</xsl:with-param>					</xsl:call-template>				</xsl:for-each>			</xsl:when>			<xsl:otherwise>				<xsl:call-template name="savegame.tabs">					<xsl:with-param name="label" select="'Aktiver Eintrag:'" />					<xsl:with-param name="options" select="sse:file/@file-name" />					<xsl:with-param name="list">						<xsl:for-each select="sse:file">							<li>								<xsl:call-template name="savegame.flex">									<xsl:with-param name="items">										<xsl:for-each select="*">											<div>												<xsl:apply-templates select="." mode="item" />											</div>										</xsl:for-each>									</xsl:with-param>								</xsl:call-template>							</li>						</xsl:for-each>					</xsl:with-param>				</xsl:call-template>			</xsl:otherwise>		</xsl:choose>	</xsl:template></xsl:stylesheet>